# ==========================================
# Tawatch Backend Environment Variables
# ==========================================
# Example environment file for Docker deployment.
# Copy this file to .env and customize values for your environment.
# DO NOT commit .env file with real secrets to Git.

# ==========================================
# APPLICATION SETTINGS
# ==========================================

# Application name used in logs and service discovery
APP_NAME=tawatch

# Active Spring profile for environment-specific configuration
SPRING_PROFILES_ACTIVE=docker

# ==========================================
# SERVER CONFIGURATION
# ==========================================

# Host port mapping (for Docker)
HOST_PORT=8080

# Internal server port (should match HOST_PORT for Docker)
SERVER_PORT=8080

# Base context path for API endpoints
SERVER_CONTEXT_PATH=/api/tawatch

# Maximum number of worker threads
SERVER_MAX_THREADS=200

# Minimum number of worker threads
SERVER_MIN_THREADS=20

# Connection timeout in milliseconds
SERVER_CONNECTION_TIMEOUT=5000

# Maximum queue length for incoming connection requests
SERVER_ACCEPT_COUNT=100

# Maximum number of connections
SERVER_MAX_CONNECTIONS=1000

# ==========================================
# DATABASE CONFIGURATION (MySQL)
# ==========================================

# Database host (must match the Docker Compose service name, default: 'mysql')
DB_HOST=mysql

# Database port (MySQL default is 3306)
DB_PORT=3306

# Database external port (MySQL default is 3306)
DB_EXTERNAL_PORT=3306

# Database name
DB_NAME=tawatch_db

# Database username
DB_USERNAME=tawatch_user

# Database password (CHANGE THIS in production!)
DB_PASSWORD=password

# Database root password (CHANGE THIS in production!)
DB_ROOT_PASSWORD=password

# Database timezone (Asia/Ho_Chi_Minh for Vietnam)
DB_TIMEZONE=Asia/Ho_Chi_Minh

# Enable SSL for database connection (should be 'true' in production)
DB_USE_SSL=false

# Allow public key retrieval for MySQL authentication
DB_ALLOW_PUBLIC_KEY_RETRIEVAL=true

# Maximum number of connections in the pool
DB_POOL_SIZE=10

# Minimum number of idle connections in the pool
DB_POOL_MIN_IDLE=5

# Maximum time (ms) to wait for a connection from the pool
DB_CONNECTION_TIMEOUT=30000

# Maximum time (ms) a connection can remain idle in the pool
DB_IDLE_TIMEOUT=600000

# Maximum lifetime (ms) of a connection in the pool
DB_MAX_LIFETIME=1800000

# Query to test database connection validity
DB_TEST_QUERY='SELECT 1'

# ==========================================
# MAIL CONFIGURATION (SMTP)
# ==========================================

# SMTP server hostname
# Common providers:
#   - Gmail: smtp.gmail.com
#   - Outlook: smtp-mail.outlook.com
#   - Yahoo: smtp.mail.yahoo.com
MAIL_HOST=smtp.gmail.com

# SMTP server port
# Common ports:
#   - 587: TLS/STARTTLS (recommended)
#   - 465: SSL
#   - 25: Unencrypted (not recommended)
MAIL_PORT=587

# SMTP authentication username (usually your email address)
MAIL_USERNAME=your-email@gmail.com

# SMTP authentication password
# For Gmail: Use App Password, not regular password
# For other providers: Use app-specific password or regular password
# WARNING: Never commit real passwords to version control!
MAIL_PASSWORD=your-app-password

# Enable SMTP authentication
MAIL_SMTP_AUTH=true

# Enable STARTTLS encryption (upgrade plain connection to TLS)
# Required for port 587
MAIL_STARTTLS_ENABLE=true

# Connection timeout (milliseconds)
# Maximum time to wait for SMTP server connection
MAIL_CONNECTION_TIMEOUT=5000

# Socket read timeout (milliseconds)
# Maximum time to wait for SMTP server response
MAIL_TIMEOUT=5000

# Socket write timeout (milliseconds)
# Maximum time to wait for writing to SMTP server
MAIL_WRITE_TIMEOUT=5000

# ==========================================
# OAUTH2 GOOGLE CONFIGURATION
# ==========================================

# Google OAuth2 Client ID
# How to get:
#   1. Go to https://console.cloud.google.com/
#   2. Create a project or select existing project
#   3. Navigate to "APIs & Services" > "Credentials"
#   4. Create OAuth 2.0 Client ID (Web application)
#   5. Add authorized redirect URIs:
#      - http://localhost:8080/login/oauth2/code/google (development)
#      - https://yourdomain.com/api/tawatch/login/oauth2/code/google (production)
# WARNING: Keep this confidential, never commit to version control!
GOOGLE_CLIENT_ID=your-google-client-id

# Google OAuth2 Client Secret
# Obtained from Google Cloud Console when creating OAuth 2.0 Client ID
# WARNING: This is highly sensitive data! Use environment variables in production!
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Frontend redirect URL after successful OAuth2 authentication
# This is where the backend redirects users after OAuth2 login completes
# Format: Frontend URL with OAuth2 success callback path
# Examples:
#   - http://localhost:5173/oauth2/success (local development with Vite)
#   - https://app.yourdomain.com/oauth2/success (production)
# The frontend should handle this callback to extract JWT tokens from URL parameters
OAUTH2_SUCCESS_URL=http://localhost:5173/oauth2/success

# Frontend redirect URL after failed OAuth2 authentication
# This is where the backend redirects users when OAuth2 login fails
# Format: Frontend URL with OAuth2 error callback path
# Examples:
#   - http://localhost:5173/oauth2/error (local development with Vite)
#   - https://app.yourdomain.com/oauth2/error (production)
# The frontend should handle this callback to display error messages
OAUTH2_FAILURE_URL=http://localhost:5173/oauth2/error

# ==========================================
# JPA / HIBERNATE SETTINGS
# ==========================================

# Show SQL queries in logs (should be 'false' in production)
JPA_SHOW_SQL=false

# Hibernate dialect (MySQL8Dialect for MySQL 8+)
HIBERNATE_DIALECT=org.hibernate.dialect.MySQL8Dialect

# Add comments to generated SQL
HIBERNATE_SQL_COMMENTS=true

# Batch size for JDBC operations
HIBERNATE_BATCH_SIZE=20

# Optimize insert ordering for batching
HIBERNATE_ORDER_INSERTS=true

# Optimize update ordering for batching
HIBERNATE_ORDER_UPDATES=true

# ==========================================
# JWT (JSON WEB TOKEN) CONFIGURATION
# ==========================================

# JWT secret key for signing and verifying tokens (CHANGE THIS in production!)
# Minimum recommended length: 256 bits (32 characters)
# Generate a strong secret with: openssl rand -base64 32
JWT_SECRET=ChangeThisJWTSecretInProduction

# Access token expiration duration (ISO-8601 Duration format)
# Format: PT[hours]H[minutes]M[seconds]S
# Examples: PT15M (15 minutes), PT1H (1 hour)
# Recommended: Short-lived (5-15 minutes) for better security
JWT_ACCESS_EXPIRATION=PT10M

# Refresh token expiration duration (ISO-8601 Duration format)
# Format: P[days]D or PT[hours]H
# Examples: P7D (7 days), P30D (30 days)
# Recommended: Longer-lived (7-30 days) to avoid frequent re-authentication
JWT_REFRESH_EXPIRATION=P7D

# Reset password token expiration duration (ISO-8601 Duration format)
# Format: PT[hours]H[minutes]M
# Examples: PT15M (15 minutes), PT30M (30 minutes)
# Recommended: Short-lived (15-30 minutes) for security
JWT_RESET_PASSWORD_EXPIRATION=PT15M

# JWT issuer identifier (appears in 'iss' claim)
# Used to identify the system that issued the token
JWT_ISSUER=TAwatch-System

# ==========================================
# CORS (Cross-Origin Resource Sharing)
# ==========================================

# Allowed origins for CORS requests
# Format: Comma-separated list of origins (URLs)
# Examples:
#   - Single origin: https://example.com
#   - Multiple origins: https://example.com,https://app.example.com
#   - Allow all (NOT recommended in production): *
# WARNING: Never use '*' in production when credentials are enabled!
CORS_ALLOWED_ORIGINS=https://yourdomain

# Allowed HTTP methods for CORS requests
# Format: Comma-separated list of HTTP methods
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH

# Allowed headers in CORS requests
# Use '*' to allow all headers or specify comma-separated list
# Examples: Authorization,Content-Type,X-Requested-With
CORS_ALLOWED_HEADERS=*

# Allow credentials (cookies, authorization headers) in CORS requests
# Set to 'true' if frontend needs to send cookies or auth headers
# WARNING: When 'true', allowed-origins MUST NOT be '*'
CORS_ALLOW_CREDENTIALS=true

# Maximum age (duration) for caching CORS preflight requests
# Format: ISO-8601 Duration format (PT[hours]H or PT[minutes]M)
# Examples: PT1H (1 hour), PT30M (30 minutes)
CORS_MAX_AGE=PT1H

# ==========================================
# CACHE CONFIGURATION
# ==========================================

# OTP (One-Time Password) Cache Configuration

# Maximum number of OTP entries that can be stored in the cache
# Once this limit is reached, least recently used entries are evicted
OTP_MAXIMUM_SIZE=10000

# Time duration after which an OTP entry expires and is automatically removed
# Format: ISO-8601 Duration format (PT[minutes]M or PT[seconds]S)
# Examples: PT5M (5 minutes), PT10M (10 minutes), PT30S (30 seconds)
# Recommended: 5-10 minutes for security
OTP_EXPIRE_AFTER=PT5M

# Maximum number of failed verification attempts allowed per OTP
# After exceeding this limit, the OTP is invalidated
# Recommended: 3-5 attempts to prevent brute-force attacks
OTP_MAX_ATTEMPTS=5

# Initial capacity of the cache (optimization for memory allocation)
# Should be set based on expected concurrent OTP requests
OTP_INITIAL_CAPACITY=100

# Maximum number of times an OTP can be resent to the same user
# Prevents abuse and spam
OTP_MAX_RESEND=3

# Cooldown period between OTP resend requests
# Format: ISO-8601 Duration format (PT[minutes]M or PT[seconds]S)
# Examples: PT1M (1 minute), PT2M (2 minutes), PT30S (30 seconds)
# Prevents rapid resend spam
OTP_RESEND_COOLDOWN=PT1M

# ==========================================
# CLOUDINARY STORAGE CONFIGURATION
# ==========================================

# Cloudinary cloud name (unique identifier for your Cloudinary account)
# How to get:
#   1. Go to https://cloudinary.com/
#   2. Sign up or log in to your account
#   3. Navigate to Dashboard
#   4. Find your cloud name in the "Account Details" section
# WARNING: Keep this confidential, never commit to version control!
CLOUDINARY_CLOUD_NAME=your_cloud_name

# Cloudinary API Key for authentication
# Found in the same "Account Details" section on your Cloudinary Dashboard
# WARNING: This is sensitive data! Use environment variables in production!
CLOUDINARY_API_KEY=your_api_key

# Cloudinary API Secret for secure authentication
# Found in the same "Account Details" section on your Cloudinary Dashboard
# WARNING: This is highly sensitive data! Never expose this publicly!
CLOUDINARY_API_SECRET=your_api_secret

# Folder paths for different types of files in Cloudinary
# Organize your files by using different folder paths for different content types

# Folder path for user profile avatars
CLOUDINARY_FOLDER_AVATARS=tawatch/avatars

# Folder path for product images
CLOUDINARY_FOLDER_PRODUCTS=tawatch/products

# Folder path for brand images (logos, brand assets)
CLOUDINARY_FOLDER_BRAND=tawatch/brand

# Folder path for category images
CLOUDINARY_FOLDER_CATEGORIES=tawatch/categories

# ==========================================
# FLYWAY MIGRATION SETTINGS
# ==========================================

# Location of migration scripts
FLYWAY_LOCATIONS=classpath:db/migration

# ==========================================
# SWAGGER / OPENAPI
# ==========================================

# Path to OpenAPI documentation endpoint
SWAGGER_API_DOCS_PATH=/v3/api-docs

# Path to Swagger UI interface
SWAGGER_UI_PATH=/swagger-docs

# Enable OpenAPI documentation generation (should be 'false' in production)
SWAGGER_ENABLED=false

# Enable Swagger UI interface (should be 'false' in production)
SWAGGER_UI_ENABLED=false

# Sort operations by HTTP method (alpha, method)
SWAGGER_OPERATIONS_SORTER=method

# Sort tags alphabetically
SWAGGER_TAGS_SORTER=alpha

# Display request duration in Swagger UI
SWAGGER_DISPLAY_REQUEST_DURATION=true

# Show Spring Boot Actuator endpoints in Swagger UI (should be 'false' in production)
SWAGGER_SHOW_ACTUATOR=false

# ==========================================
# SPRING BOOT ACTUATOR
# ==========================================

# Comma-separated list of exposed actuator endpoints
ACTUATOR_EXPOSED_ENDPOINTS=health,info

# Base path for actuator endpoints
ACTUATOR_BASE_PATH=/actuator

# Show detailed health information (should be 'when-authorized' in production)
ACTUATOR_HEALTH_SHOW_DETAILS=when-authorized

# Show health component details (should be 'when-authorized' in production)
ACTUATOR_HEALTH_SHOW_COMPONENTS=when-authorized

# Enable database health check
ACTUATOR_HEALTH_DB=true

# Enable mail health check
ACTUATOR_HEALTH_MAIL=true

# ==========================================
# LOGGING CONFIGURATION
# ==========================================

# Root logger level (affects all logs unless overridden)
LOG_ROOT=INFO

# Application-specific logging level (DEBUG, INFO, WARN, ERROR)
LOG_APP_LEVEL=DEBUG

# Spring Web logging level
LOG_SPRING_WEB=DEBUG

# Hibernate SQL logging level
LOG_HIBERNATE_SQL=DEBUG

# Hibernate parameter binding logging (TRACE shows parameter values - WARNING: may expose sensitive data)
LOG_HIBERNATE_BIND=TRACE

# Flyway migration logging level
LOG_FLYWAY=DEBUG

# ==========================================
# NOTES FOR PRODUCTION DEPLOYMENT
# ==========================================
# 1. Change all passwords to strong, unique values
# 2. Change JWT_SECRET to a strong, random value (minimum 32 characters)
# 3. Set DB_USE_SSL=true
# 4. Set root logging levels to INFO or WARN
# 5. Consider disabling Hibernate parameter binding (LOG_HIBERNATE_BIND=OFF)
# 6. Use external secret management (Docker secrets, Kubernetes secrets, HashiCorp Vault)